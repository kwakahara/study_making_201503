SELECT 
	date_format(cnt.date, '%Y-%m-%d') as DATE,
	sum(cnt.join_cnt) as JOINED_COUNT,
	sum(cnt.left_cnt) as LEFT_COUNT
FROM 
	(SELECT
		user.LEFT_DATE date,
		0 as join_cnt,
		1 as left_cnt
	FROM
		users user
	WHERE
		user.LEFT_DATE is not null 
	UNION ALL 
	SELECT 
		user.JOINED_DATE date,
		1 as join_cnt,
		0 as left_cnt 
	FROM
		users user
	) AS cnt 
GROUP BY cnt.date
ORDER BY date