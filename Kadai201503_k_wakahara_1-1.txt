select 
	date_format(CNT.DATE, '%Y-%m-%d') as DATE,
	sum(CNT.JOIN_CNT) as JOINED_COUNT,
	sum(CNT.LEFT_CNT) as LEFT_COUNT
from 
	(select
		USER.LEFT_DATE DATE,
		0 as JOIN_CNT,
		1 as LEFT_CNT
	from
		users USER
	where
		USER.LEFT_DATE is not null 
	union all 
	select 
		USER.JOINED_DATE DATE,
		1 as JOIN_CNT,
		0 as LEFT_CNT 
	from
		users USER
	) as CNT 
group by CNT.DATE
order by DATE